const Marksheet = require('mongoose').model('Marksheet');
const Exam = require('mongoose').model('Exam');
const mongoose = require("mongoose");

const myDelete = function(exam){
	for(let i=0; i< exam.length; i++){
		Exam.findOne({
			_id: exam[i]
		})
		.remove(function(err){
			if(err) return res.send('some error occured');
		});
	}
}

module.exports = function(_id){
	Marksheet.findOne({
		_id
	})
	.exec(function(err, marksheet){
		if(err) return res.send('some error occured');
		//First delete exam subdocuments
		if(marksheet){
			myDelete(marksheet.quiz);
			myDelete(marksheet.mid);
			myDelete(marksheet.assignment);
			myDelete(marksheet.project);
			myDelete(marksheet.presentation);
			myDelete(marksheet.fieldWork);
			myDelete(marksheet.final);
			//Now delete marksheet
			Marksheet.findOne({
				_id
			})
			.remove(function(err){
				if (err) return res.send('some error occured');
			});
		}
	});
}